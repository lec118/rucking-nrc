# ëŸ¬í‚¹ ì¶”ì ê¸° (Rucking Tracker)

ì •í™•í•œ GPS ê¸°ë°˜ ëŸ¬í‚¹(ë¬´ê²Œ ë°°ë‚­ ì°©ìš© ê±·ê¸°/ë‹¬ë¦¬ê¸°) ìš´ë™ ì¶”ì  ë° ì •ëŸ‰ì  íŠ¸ë ˆì´ë‹ ë¶„ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

## ì£¼ìš” íŠ¹ì§•

### ğŸ¯ ì •ë°€í•œ ì‹œê°„ ì¸¡ì •
- **ë‹¨ì¡° ì‹œê°„(Monotonic Clock)**: `performance.now()` ì‚¬ìš©ìœ¼ë¡œ ì¼ì‹œì •ì§€/ì¬ê°œ ì‹œ ë“œë¦¬í”„íŠ¸ ì œë¡œ
- **ë™ì  ì‹œê°„ í¬ë§·**:
  - 1ì‹œê°„ ë¯¸ë§Œ: `mm:ss` (í° í°íŠ¸)
  - 1ì‹œê°„ ì´ìƒ: `HH:mm:ss` (ìµœì í™”ëœ í°íŠ¸)

### ğŸ“ ìŠ¤ë§ˆíŠ¸ GPS ì¶”ì 
- **ì •í™•ë„ í•„í„°ë§**: 30m ì´ˆê³¼ ìƒ˜í”Œ ìë™ ë¬´ì‹œ
- **ì†ë„ ìŠ¤ë¬´ë”©**: ì´ë™ í‰ê·  + ê°„ë‹¨í•œ ì¹¼ë§Œ í•„í„°
- **ì •ì§€ ê°ì§€**: ì†ë„ < 0.4 m/sê°€ 5ì´ˆ ì´ìƒ ì§€ì† ì‹œ ìë™ ê°ì§€
  - ì •ì§€ ì¤‘: í˜ì´ìŠ¤ `--:--` í‘œì‹œ
  - `movingTime`, `movingDistance` ì¦ê°€ ì¤‘ë‹¨

### ğŸ—ºï¸ ì‹¤ì‹œê°„ ì§€ë„ ì¶”ì 
- ì‚¬ìš©ì ìœ„ì¹˜ ìë™ ì¤‘ì‹¬ ì´ë™
- ë°©í–¥(heading) ë°˜ì˜
- ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜
- Polyline ê²½ë¡œ ì‹¤ì‹œê°„ í‘œì‹œ

### ğŸ“Š ì •ëŸ‰ì  íŠ¸ë ˆì´ë‹ ë¶„ì„ (RuckScore ì‹œìŠ¤í…œ)

ìš´ë™ ì¢…ë£Œ í›„ 6ê°€ì§€ ê³¼í•™ì  ì§€í‘œ ê³„ì‚°:

1. **ì—ë„ˆì§€ ì†Œëª¨ (kcal)**
   ```
   MET = 1.0 + 0.9 Ã— ì†ë„(km/h)
   ë¶€í•˜ê³„ìˆ˜ = 1 + (ë°°ë‚­ë¬´ê²Œ / ì²´ì¤‘) Ã— 0.6
   kcal = MET Ã— ì²´ì¤‘ Ã— (ì‹œê°„/60) Ã— ë¶€í•˜ê³„ìˆ˜ Ã— ë³´ì •ê³„ìˆ˜
   ```

2. **ì‹¬í ë¶€í•˜ (TRIMP/eTRIMP)**
   - ì‹¬ë°•ìˆ˜ ìˆì„ ë•Œ: HR ê¸°ë°˜ TRIMP
   - ì‹¬ë°•ìˆ˜ ì—†ì„ ë•Œ: ì†ë„ ê¸°ë°˜ eTRIMP

3. **ê¸°ê³„ì  ë¶€í•˜ (kgÂ·km)**
   ```
   ê¸°ê³„ì ë¶€í•˜ = ë°°ë‚­ë¬´ê²Œ(kg) Ã— ê±°ë¦¬(km)
   ```

4. **ìˆ˜ì§ ì¼ëŸ‰ (kJ)**
   ```
   ìˆ˜ì§ì¼ = (ì²´ì¤‘ + ë°°ë‚­ë¬´ê²Œ) Ã— 9.81 Ã— ê³ ë„ìƒìŠ¹(m) / 1000
   ```

5. **ê³¨ê²©/ê·¼ìœ¡ ìê·¹ (BMS 0-10)**
   ```
   BMS = 10 Ã— (0.4Ã—ë¶€í•˜ì •ê·œí™” + 0.3Ã—ê±°ë¦¬ì •ê·œí™” + 0.3Ã—ê³ ë„ì •ê·œí™”)
   ```

6. **ì¢…í•© ì ìˆ˜ (RuckScore 0-100)**
   ```
   RuckScore = 100 Ã— (0.3Ã—ì—ë„ˆì§€ + 0.25Ã—TRIMP + 0.25Ã—ê¸°ê³„ì  + 0.10Ã—ìˆ˜ì§ + 0.10Ã—BMS)
   ```

#### RuckScore í•´ì„
- **0-40**: ê°€ë²¼ìš´ ìš´ë™ (íšŒë³µ/ì…ë¬¸)
- **40-70**: ì¤‘ê°„ ê°•ë„ (ìœ ì§€/ë°œì „)
- **70-100**: ê³ ê°•ë„ (ì±Œë¦°ì§€/ê²½ìŸ)

### ğŸ“± PWA ì§€ì›
- ì˜¤í”„ë¼ì¸ ë™ì‘ (Service Worker)
- í™ˆ í™”ë©´ ì¶”ê°€ ê°€ëŠ¥
- í™”ë©´ êº¼ì§ ë°©ì§€ (Wake Lock API)

### âš ï¸ iOS ì œì•½ì‚¬í•­
- **PWA ëª¨ë“œ**: ë°±ê·¸ë¼ìš´ë“œì—ì„œ JavaScript ì‹¤í–‰ ì¤‘ë‹¨
  - í™”ë©´ì´ êº¼ì§€ë©´ GPS ì¶”ì  ë° íƒ€ì´ë¨¸ ë©ˆì¶¤
  - **í•´ê²°ì±…**: í™”ë©´ ìœ ì§€ ì„¤ì • ë˜ëŠ” iOS ë„¤ì´í‹°ë¸Œ ë˜í¼ ì‚¬ìš©

- **iOS ë„¤ì´í‹°ë¸Œ ë˜í¼ (Capacitor)**: ë°±ê·¸ë¼ìš´ë“œ ì¶”ì  ì™„ë²½ ì§€ì›
  - í™”ë©´ êº¼ì§„ ìƒíƒœì—ì„œë„ GPS ì¶”ì  ê³„ì†
  - ì„¤ì • ê°€ì´ë“œ: [README-iOS.md](./README-iOS.md)

---

## ì‹œì‘í•˜ê¸°

### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­
- Node.js 18+
- npm ë˜ëŠ” yarn

### ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/yourusername/rucking-tracker.git
cd rucking-tracker

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env.local
# .env.local íŒŒì¼ì„ ì—´ì–´ NEXT_PUBLIC_MAP_TILE_KEY ì…ë ¥
```

### MapTiler API í‚¤ ë°œê¸‰
1. [MapTiler Cloud](https://cloud.maptiler.com/) ê°€ì…
2. ë¬´ë£Œ API í‚¤ ìƒì„±
3. `.env.local`ì— í‚¤ ì…ë ¥:
   ```
   NEXT_PUBLIC_MAP_TILE_KEY=your_key_here
   ```

### ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
npm run dev
```

ë¸Œë¼ìš°ì €ì—ì„œ [http://localhost:3000](http://localhost:3000) ì ‘ì†

### í”„ë¡œë•ì…˜ ë¹Œë“œ

```bash
npm run build
npm start
```

---

## ì‚¬ìš© ë°©ë²•

### 1. ì´ˆê¸° ì„¤ì •
- **ì²´ì¤‘ ì…ë ¥** (kg): ì—ë„ˆì§€ ì†Œëª¨ ê³„ì‚°ì— ì‚¬ìš©
- **ë°°ë‚­ ë¬´ê²Œ ì…ë ¥** (kg): ë¶€í•˜ ê³„ì‚°ì— ì‚¬ìš©
- ìœ„ì¹˜ ê¶Œí•œ í—ˆìš©

### 2. ìš´ë™ ì‹œì‘
- **Start** ë²„íŠ¼ í´ë¦­
- GPS ì‹ í˜¸ ì¡í ë•Œê¹Œì§€ ëŒ€ê¸° (ë³´í†µ 5-10ì´ˆ)
- ì§€ë„ì— íŒŒë€ ì (í˜„ì¬ ìœ„ì¹˜)ê³¼ ë¹¨ê°„ ì„ (ê²½ë¡œ) í‘œì‹œ

### 3. ìš´ë™ ì¤‘
- **ì‹¤ì‹œê°„ ì§€í‘œ í™•ì¸**:
  - TIME: ê²½ê³¼ ì‹œê°„
  - DIST: ì´ ê±°ë¦¬
  - PACE: í˜„ì¬ í˜ì´ìŠ¤ (ì •ì§€ ì‹œ `--:--`)
  - ELEV: ê³ ë„ ìƒìŠ¹

- **ì¼ì‹œì •ì§€**: Pause ë²„íŠ¼
- **ì¬ê°œ**: Resume ë²„íŠ¼

### 4. ìš´ë™ ì¢…ë£Œ
- **End** ë²„íŠ¼ í´ë¦­
- RuckScore ë° íŠ¸ë ˆì´ë‹ ì§€í‘œ í™•ì¸:
  - ì—ë„ˆì§€ ì†Œëª¨ (kcal)
  - ì‹¬í ë¶€í•˜ (TRIMP)
  - ê¸°ê³„ì  ë¶€í•˜ (kgÂ·km)
  - ìˆ˜ì§ ì¼ëŸ‰ (kJ)
  - ê³¨ê²©/ê·¼ìœ¡ ìê·¹ (BMS)
  - ì¢…í•© ì ìˆ˜ (RuckScore)

### 5. ë³´ì •
- ì²˜ìŒ ëª‡ ë²ˆì˜ ìš´ë™ í›„ ì‹¤ì œ ì†Œëª¨ ì¹¼ë¡œë¦¬ì™€ ë¹„êµí•˜ì—¬ ë³´ì •ê³„ìˆ˜ ì¡°ì • ê°€ëŠ¥
- ê¸°ë³¸ê°’: `1.15` (í‰ê· ì ì¸ ëŸ¬í‚¹ íš¨ìœ¨)

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
rucking-tracker/
â”œâ”€â”€ domain/                    # ë„ë©”ì¸ ë¡œì§ (ìˆœìˆ˜ í•¨ìˆ˜)
â”‚   â””â”€â”€ WorkoutSession.ts      # ìš´ë™ ìƒíƒœ ë¨¸ì‹ , ì‹œê°„ ê³„ì‚°
â”œâ”€â”€ services/                  # í”Œë«í¼ë³„ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ GeoService.web.ts      # ì›¹ GPS ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ TimeSource.web.ts      # ì›¹ ë‹¨ì¡° ì‹œê°„ ì†ŒìŠ¤
â”œâ”€â”€ lib/                       # ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ paceSmoother.ts        # ì†ë„ ìŠ¤ë¬´ë”© (ì´ë™ í‰ê·  + ì¹¼ë§Œ í•„í„°)
â”‚   â””â”€â”€ trainingMetrics.ts     # íŠ¸ë ˆì´ë‹ ì§€í‘œ ê³„ì‚°
â”œâ”€â”€ features/live/             # UI ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ LiveWorkoutView.tsx    # ë©”ì¸ ìš´ë™ í™”ë©´
â”œâ”€â”€ components/                # ì¬ì‚¬ìš© ê°€ëŠ¥ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ RuckScoreGauge.tsx     # SVG ì›í˜• ê²Œì´ì§€
â”œâ”€â”€ app/                       # Next.js App Router
â”‚   â”œâ”€â”€ (workout)/page.tsx     # ìš´ë™ í˜ì´ì§€
â”‚   â””â”€â”€ api/workouts/route.ts  # ìš´ë™ ì €ì¥ API
â”œâ”€â”€ public/                    # ì •ì  íŒŒì¼
â”‚   â”œâ”€â”€ manifest.webmanifest   # PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸
â”‚   â””â”€â”€ sw.js                  # Service Worker
â”œâ”€â”€ ios/                       # iOS ë„¤ì´í‹°ë¸Œ ë˜í¼ (ì„ íƒì‚¬í•­)
â”‚   â””â”€â”€ App/                   # Swift ì½”ë“œ
â””â”€â”€ tests/                     # í…ŒìŠ¤íŠ¸
    â””â”€â”€ unit/                  # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
```

---

## ê¸°ìˆ  ìŠ¤íƒ

- **í”„ë ˆì„ì›Œí¬**: Next.js 14 (App Router)
- **ì–¸ì–´**: TypeScript (strict mode)
- **ìŠ¤íƒ€ì¼ë§**: Tailwind CSS
- **ì§€ë„**: MapLibre GL JS
- **GPS**: Web Geolocation API
- **PWA**: Service Worker, Web App Manifest
- **iOS ë˜í¼**: Capacitor (ì„ íƒì‚¬í•­)
- **í…ŒìŠ¤íŠ¸**: Vitest

---

## ê°œì¸ì •ë³´ ë³´í˜¸

### ìœ„ì¹˜ ë°ì´í„° ì²˜ë¦¬ ì›ì¹™
1. **ê¸°ë³¸**: ëª¨ë“  ê³„ì‚°ì€ ê¸°ê¸° ë‚´ì—ì„œë§Œ ìˆ˜í–‰
2. **ì„œë²„ ì €ì¥**: ìµœì†Œí•œì˜ ìš”ì•½ ë°ì´í„°ë§Œ (ì‚¬ìš©ì ë™ì˜ ì‹œ)
   - ê±°ë¦¬, ì‹œê°„, í‰ê·  ì†ë„, RuckScore
   - **ê²½ë¡œ ë°ì´í„°(GPS ì¢Œí‘œ)ëŠ” ì ˆëŒ€ ì €ì¥í•˜ì§€ ì•ŠìŒ**
3. **íˆ¬ëª…ì„±**: ì €ì¥ë˜ëŠ” ë°ì´í„° ëª©ë¡ ëª…ì‹œ
4. **ì œì–´ê¶Œ**: ì‚¬ìš©ìê°€ ì–¸ì œë“ ì§€ ë°ì´í„° ì‚­ì œ ê°€ëŠ¥

---

## ì•ˆì „ ìˆ˜ì¹™

### ë¶€ìƒ ì˜ˆë°© (ACWR)
- **Acute:Chronic Workload Ratio**: ê¸‰ì„±ë¶€í•˜ / ë§Œì„±ë¶€í•˜ ë¹„ìœ¨
- **ê¶Œì¥ ë²”ìœ„**: 0.8 - 1.3
- **ìœ„í—˜ êµ¬ê°„**: > 1.5 (ë¶€ìƒ ìœ„í—˜ ì¦ê°€)

### ì ì§„ì  ê³¼ë¶€í•˜
- ì£¼ë‹¹ ê±°ë¦¬ ì¦ê°€: **10% ì´í•˜**
- ë°°ë‚­ ë¬´ê²Œ ì¦ê°€: **2-3kgì”©**
- ê³ ë„ ìƒìŠ¹ ì¦ê°€: ì„œì„œíˆ

### íšŒë³µ
- ê³ ê°•ë„ ìš´ë™ í›„ 48ì‹œê°„ íœ´ì‹
- RuckScore 70+ ìš´ë™ì€ ì£¼ 2íšŒ ì´í•˜ ê¶Œì¥

---

## ë°°í¬

### Vercel (ì¶”ì²œ)

```bash
# Vercel CLI ì„¤ì¹˜
npm i -g vercel

# ë°°í¬
vercel --prod
```

í™˜ê²½ ë³€ìˆ˜ ì„¤ì •:
- Vercel ëŒ€ì‹œë³´ë“œ â†’ í”„ë¡œì íŠ¸ â†’ Settings â†’ Environment Variables
- `NEXT_PUBLIC_MAP_TILE_KEY` ì…ë ¥

### Netlify

```bash
# Netlify CLI ì„¤ì¹˜
npm i -g netlify-cli

# ë°°í¬
netlify deploy --prod
```

---

## iOS ë„¤ì´í‹°ë¸Œ ë˜í¼ (ì„ íƒì‚¬í•­)

ë°±ê·¸ë¼ìš´ë“œ ì¶”ì ì„ ìœ„í•´ì„œëŠ” Capacitorë¥¼ ì‚¬ìš©í•œ iOS ë„¤ì´í‹°ë¸Œ ë˜í¼ê°€ í•„ìš”í•©ë‹ˆë‹¤.

ìƒì„¸ ê°€ì´ë“œ: [README-iOS.md](./README-iOS.md)

---

## í…ŒìŠ¤íŠ¸

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm test

# ì»¤ë²„ë¦¬ì§€
npm run test:coverage
```

---

## ë¬¸ì œ í•´ê²°

### "ìœ„ì¹˜ ê¶Œí•œ ê±°ë¶€ë¨"
- ë¸Œë¼ìš°ì € ì„¤ì • â†’ ìœ„ì¹˜ ê¶Œí•œ í—ˆìš©
- iOS: ì„¤ì • â†’ Safari â†’ ìœ„ì¹˜ â†’ í—ˆìš©

### "ì§€ë„ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ"
- `.env.local`ì— `NEXT_PUBLIC_MAP_TILE_KEY` ì„¤ì • í™•ì¸
- MapTiler í‚¤ ìœ íš¨ì„± í™•ì¸

### "iOSì—ì„œ ë°±ê·¸ë¼ìš´ë“œ ì¶”ì  ì•ˆ ë¨"
- PWAëŠ” ë°±ê·¸ë¼ìš´ë“œ ì œì•½ ìˆìŒ (ì •ìƒ)
- í™”ë©´ ìœ ì§€ ì„¤ì • í™œì„±í™” ê¶Œì¥
- ë˜ëŠ” iOS ë„¤ì´í‹°ë¸Œ ë˜í¼ ì‚¬ìš©: [README-iOS.md](./README-iOS.md)

### "í˜ì´ìŠ¤ê°€ '--:--'ë¡œ ê³„ì† í‘œì‹œë¨"
- GPS ì •í™•ë„ê°€ ë‚®ì„ ìˆ˜ ìˆìŒ (ì‹¤ë‚´, ê±´ë¬¼ ì‚¬ì´)
- ì•¼ì™¸ ê°œí™œì§€ë¡œ ì´ë™
- GPS ì‹ í˜¸ ì•ˆì •í™”ê¹Œì§€ 30ì´ˆ ì •ë„ ëŒ€ê¸°

### "ê±°ë¦¬ê°€ ë¶€ì •í™•í•¨"
- GPS ì •í™•ë„ í•„í„°ë§ ì‘ë™ ì¤‘ (30m ì´ˆê³¼ ìƒ˜í”Œ ë¬´ì‹œ)
- ì‹¤ë‚´/í„°ë„ì—ì„œëŠ” ê±°ë¦¬ ì¸¡ì • ë¶€ì •í™•
- ê³ ì¸µ ë¹Œë”© ì‚¬ì´ì—ì„œë„ ë‹¤ì¤‘ ê²½ë¡œ íš¨ê³¼ë¡œ ë¶€ì •í™•í•  ìˆ˜ ìˆìŒ

---

## ê¸°ì—¬

ì´ìŠˆ ë° í’€ ë¦¬í€˜ìŠ¤íŠ¸ í™˜ì˜í•©ë‹ˆë‹¤!

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## ë¼ì´ì„ ìŠ¤

MIT License - ììœ ë¡­ê²Œ ì‚¬ìš© ë° ìˆ˜ì • ê°€ëŠ¥

---

## ì—°ë½ì²˜

- GitHub Issues: [https://github.com/yourusername/rucking-tracker/issues](https://github.com/yourusername/rucking-tracker/issues)
- Email: your.email@example.com

---

## ì°¸ê³  ìë£Œ

### ëŸ¬í‚¹ ê´€ë ¨
- [GORUCK Training](https://www.goruck.com/pages/training)
- [Military Rucking Guidelines](https://www.military.com/military-fitness/army-fitness-requirements/army-ruck-march-standards)

### íŠ¸ë ˆì´ë‹ ê³¼í•™
- [TRIMP (Training Impulse)](https://www.trainingpeaks.com/blog/what-is-trimp/)
- [ACWR (Acute:Chronic Workload Ratio)](https://www.scienceforsport.com/acwr/)
- [MET Values](https://sites.google.com/site/compendiumofphysicalactivities/)

### ê¸°ìˆ  ë¬¸ì„œ
- [Geolocation API](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API)
- [Performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now)
- [MapLibre GL JS](https://maplibre.org/maplibre-gl-js-docs/api/)
- [Capacitor](https://capacitorjs.com/docs)

---

**í–‰ë³µí•œ ëŸ¬í‚¹ ë˜ì„¸ìš”! ğŸ’ğŸƒâ€â™‚ï¸**
